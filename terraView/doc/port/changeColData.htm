<html>

<head>
<title>Alterar dados de coluna</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
</head>

<body>
<div align="justify">
<p align=center>
	<strong><u>
		<span style='font-size: 13.5pt;font-family:Arial'>Alterar dados de coluna</span></u></strong>
</p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">O módulo de alterar dados de coluna é ativado através do grid do TerraView. 
  Para sua correta ativação é necessário que o nome da coluna, sobre a qual &eacute; 
  desejada a altera&ccedil;&atilde;o, esteja visível no grid. Em seguida, para 
  ativar o m&oacute;dulo, posicione o mouse sobre o nome da coluna e com o botão 
  direito selecione o item &quot;<strong>Alterar Dados da Coluna</strong>...&quot;. 
  A interface da Figura 1 &eacute; ativada.<o:p></o:p></span></p>

<p class="MsoNormal" align="center"
style="margin-top:6.0pt;margin-right:0cm;
margin-bottom:12.0pt;margin-left:0cm;text-align:center"><span
style="font-family:
Tahoma"><img src="changeColData_arquivos/changeColData.PNG" width="304" height="307"><o:p></o:p></span></p>

<p class="MsoNormal" align="center"
style="margin-top:6.0pt;margin-right:0cm;
margin-bottom:12.0pt;margin-left:0cm;text-align:center"><span
style="font-family:
Tahoma">Fig. 1 - interface de alterar dados de coluna.<o:p></o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">O módulo mostra na parte superior, apenas para informação,
o nome da coluna que recebera os novos dados.<o:p></o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">A caixa &quot;<em>Modificar</em>&quot; permite selecionar o range de linhas 
  da tabela que serão alteradas. Por default ela é configurada para &quot;Todos&quot;.<o:p></o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">A caixa &quot;<em>Operação</em>&quot; possui um combo com os nomes dos 
  atributos do tema. Ele é utilizado para ajudar na digitação correta do nome 
  do atributo. Toda vez que se ativa o combo ou um dos botões de operação é feita 
  uma cópia para a área de edição. A c&oacute;pia &eacute; colada sobre uma seleção 
  previamente existente ou colocada sobre o cursor da área de edição.<o:p></o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">O botão &quot;<em>Executar</em>&quot; aplica a alteração formulada.<o:p></o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">O botão &quot;<em>Cancelar</em>&quot; desativa o módulo.<o:p></o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">O botão &quot;<em>Ajuda</em>&quot; mostra esta tela de ajuda.<o:p></o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">&nbsp;<o:p></o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">&nbsp;<o:p></o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><b
style="mso-bidi-font-weight:
normal"><span style="font-family:Tahoma">Considerações
finais<o:p></o:p></span></b></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><b
style="mso-bidi-font-weight:
normal"><span style="font-family:Tahoma">Digitar =<o:p></o:p></span></b></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">Não digite '=' na área de edição. Para colocar, por exemplo, o valor 5 
  sobre as linhas da tabela, digite apenas 5 na área de edição e pressione o botão 
  <em>Executar</em>. As linhas da tabela receberão o valor 5.<o:p></o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">&nbsp;<o:p></o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><b
style="mso-bidi-font-weight:
normal"><span style="font-family:Tahoma">Operação com
atributos<o:p></o:p></span></b></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">Uma coluna pode receber o resultado da operação entre atributos, por exemplo, 
  a soma de dois atributos. Para isto, selecione no combo o primeiro atributo, 
  em seguida pressione o botão &quot;+&quot;, depois selecione no combo o segundo 
  atributo. Certifique-se que os atributos selecionados sejam do tipo numérico 
  para que a soma seja efetuada com &ecirc;xito. Pressione o botão <em>Executar</em>. 
  As linhas da coluna receberão a soma de valores desses dois campos.<o:p></o:p></span></p>
<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma"><o:p>OBS: Essa opera&ccedil;&atilde;o pode at&eacute; funcionar com atributos 
  do tipo string desde que todas as linhas sejam somente de valores num&eacute;ricos. 
  Quando isso n&atilde;o ocorre, dependendo do gerenciador de banco de dados, 
  </o:p></span><span
style="font-family:
Tahoma"><o:p>pode n&atilde;o executar nada, ou ent&atilde;o, pode at&eacute;:</o:p></span></p>
<ul>
  <li><span
style="font-family:
Tahoma"><o:p></o:p></span><span
style="font-family:
Tahoma"><o:p></o:p></span><span
style="font-family:
Tahoma">Calcular onde as linhas de ambos os atributos t&ecirc;m valores num&eacute;ricos 
    e </span></li>
  <li><span
style="font-family:
Tahoma">Colocar <o:p>nulo onde isso n&atilde;o ocorre.</o:p></span></li>
</ul>
<p>&nbsp;</p>
<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><b
style="mso-bidi-font-weight:
normal"><span style="font-family:Tahoma">Operação com
atributos de valor nulo<o:p></o:p></span></b></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">O resultado da operação, quando um atributo não tem valor, é nulo. No 
  exemplo anterior, o resultado de um campo será nulo quando um dos atributos 
  for nulo.<o:p></o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">&nbsp;<o:p></o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><b
style="mso-bidi-font-weight:
normal"><span style="font-family:Tahoma">Operação cujo
resultado é indeterminado<o:p></o:p></span></b></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">Quando o resultado de uma operação é indeterminado, como por exemplo, 
  a divisão de dois atributos onde o divisor é zero, o resultado &eacute; nulo.<o:p></o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">&nbsp;<o:p></o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><b
style="mso-bidi-font-weight:
normal"><span style="font-family:Tahoma">Operação usando
funções matemáticas<o:p></o:p></span></b></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">O uso de funções como log, sin, cos, etc. é possível e depende do gerenciador 
  de banco de dados. Quando isso leva a valores indeterminados como log(0) o resultado 
  é nulo.<o:p></o:p></span></p>
<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma"><o:p><b>NOTA</b>: Alguns gerenciadores de banco de dados n&atilde;o atribuem 
  valor nenhum quando h&aacute; algum resultado inv&aacute;lido. Nesses casos 
  pode-se usar a <a href="#clausura_where">clausura WHERE</a> para filtrar apenas 
  as linhas que tenham resultados v&aacute;lidos.</o:p></span></p>
<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma"><o:p></o:p></span></p>
<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma"><o:p></o:p></span><span
style="font-family:
Tahoma"><o:p></o:p></span><span
style="font-family:
Tahoma"><o:p></o:p></span><b
style="mso-bidi-font-weight:
normal"><span style="font-family:Tahoma">Atribuir valor nulo</span></b></p>
<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span style="font-family:Tahoma">Para 
  atribuir valor nulo, tecle null na &aacute;rea de edi&ccedil;&atilde;o e pressione 
  o bot&atilde;o <em>Executar</em>.<o:p></o:p></span></p>
<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span style="font-family:Tahoma"><o:p><b>OBS</b>: 
  Alguns gerenciadores de banco de dados exigem um cast para atribuir valor nulo. 
  Por exemplo,</o:p> em POSTGRESQL <o:p>deve-se colocar null::float8 ou </o:p></span><span style="font-family:Tahoma"><o:p>null::integer 
  ou null::varchar dependendo do tipo do campo.</o:p></span></p>
<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">&nbsp;<o:p></o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><b
style="mso-bidi-font-weight:
normal"><span style="font-family:Tahoma">Tema com ligação
1 para n<o:p></o:p></span></b></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">Nos casos de ligação 1 para n pode-se obter o resultado de
uma agregação utilizando-se as funções: MIN, MAX, AVG, SUM e COUNT. Isso é possível
desde que a coluna selecionada seja de uma tabela estática e esteja recebendo a
agregação de valores de uma tabela externa.<o:p></o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">Para exemplificar suponha que exista um tema de municípios ligado à tabela 
  externa <i style="mso-bidi-font-style:normal">escolas</i> e cada município possui 
  n escolas. Nessa situação para saber quantas escolas tem cada município executa-se 
  a seguinte operação:<o:p></o:p></span></p>
 
  <p><span
style="font-family:Wingdings;
mso-bidi-font-family:Tahoma"><span
style="font:7.0pt &quot;Times New Roman&quot;"> </span></span><span
style="font-family:Tahoma">COUNT(nome_escola)<o:p></o:p></span></p>
 
<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">Note que sem o uso de agregação torna-se impossível uma coluna da tabela 
  estática receber os dados de uma coluna da tabela externa, porque, neste caso 
  existem várias linhas de dado para cada linha da tabela estática.<o:p> A fun&ccedil;&atilde;o 
  de agrega&ccedil;&atilde;o reduz esses valores para um &uacute;nico e o atribue 
  para o objeto correspondente.</o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">&nbsp;<o:p></o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">Também é possível a utilização de funções matemáticas baseadas em uma 
  função de agregação, por exemplo:<o:p></o:p></span></p>
 
  <p><span
style="font-family:Tahoma">log(AVG(num_professores)) + 12<o:p></o:p></span></p>
 
<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">Entretanto, não é possível executar a agregação sobre o resultado de uma 
  função matemática, por exemplo:<o:p></o:p></span></p>
 
  <p><span
style="font-family:Wingdings;
mso-bidi-font-family:Tahoma"><span
style="font:7.0pt &quot;Times New Roman&quot;"> </span></span><span
style="font-family:Tahoma">MAX(log(num_professores))<span style="mso-spacerun: yes"> 
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>..... ERRO<o:p></o:p></span></p>
 
<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify"><span
style="font-family:Tahoma">&nbsp;<o:p></o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><b
style="mso-bidi-font-weight:
normal"><span style="font-family:Tahoma"><a name="clausura_where"></a>Uso da cl&aacute;usula 
  WHERE<o:p></o:p></span></b></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">Após a formulação da operação pode-se acrescentar a cl&aacute;usula WHERE. 
  Isso faz com que a alteração ocorra somente onde existem certas características 
  definidas na cl&aacute;usula WHERE.</span></p>
<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">OBS: o módulo executa um AND da cl&aacute;usula WHERE com a opção escolhida 
  da caixa &quot;Modificar&quot;.<o:p></o:p></span></p>

<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">Como exemplo, voltemos ao caso do número de escola por
município. Para calcular esse número somente sobre os municípios com mais de 100000
habitantes é feito o seguinte:<o:p></o:p></span></p>

<ul>
  <li><span
style="font-family:
Tahoma">Seleciona-se a opção &quot;<em>Todos</em>&quot; na caixa &quot;<em>Modificar</em>&quot; 
    e aplica-se a seguinte operação:<o:p></o:p></span></li>
</ul>
  
  <p><span
style="font-family:Tahoma">COUNT(nome_escola) WHERE pop_municipio &gt; 100000<o:p></o:p></span></p>
 
<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:0cm;text-align:justify;text-indent:35.45pt"><span
style="font-family:
Tahoma">Este mesmo resultado pode ser obtido atrav&eacute;s dos seguintes passos:</span></p>
 
  <p><span
style="font-family:
Tahoma">primeiro: saia deste m&oacute;dulo.</span></p>
  <p><span
style="font-family:
Tahoma">segundo: ative o <a href="query.htm">módulo de consulta por atributos</a></span></p>
  <p><span
style="font-family:
Tahoma">terceiro: selecione todos os municípios com mais de 100000 habitantes.</span></p>
  <p><span
style="font-family:
Tahoma">quarto: saia do m&oacute;dulo de consulta e volte ao m&oacute;dulo de 
    alterar dados de coluna.</span></p>
  
<p><span
style="font-family:
Tahoma">quinto: s</span><span
style="font-family:
Tahoma">elecione a opção Consultados na caixa <em>Modificar</em>.</span></p>
  <p><span
style="font-family:
Tahoma">sexto: aplique a seguinte operação:<o:p></o:p></span></p>
  <p><span
style="font-family:Wingdings;
mso-bidi-font-family:Tahoma"><span
style="font:7.0pt &quot;Times New Roman&quot;"> </span></span><span
style="font-family:Tahoma">COUNT(nome_escola)<o:p></o:p></span></p>
 
<p><span
style="font-family:Tahoma">O resultado &eacute; o mesmo.<o:p></o:p></span></p>
<p><span
style="font-family:Tahoma"><o:p>Essas duas formas de filtrar linhas s&atilde;o 
  extremamente &uacute;teis porque alguns gerenciadores de banco de dados n&atilde;o 
  executam nada quando h&aacute; uma opera&ccedil;&atilde;o inv&aacute;lida, tais 
  como, divis&atilde;o por zero, etc.</o:p></span></p>
<p><span
style="font-family:Tahoma"><o:p>As linhas que ficam de fora n&atilde;o sofrem 
  altera&ccedil;&atilde;o.</o:p></span></p>
<p class="MsoNormal"
style="margin-top:6.0pt;margin-right:0cm;margin-bottom:12.0pt;
margin-left:53.45pt;text-align:justify"><span
style="font-family:
Tahoma"><o:p></o:p></span></p>
<p><span
style="font-family:
Tahoma"><o:p></o:p></span><b
style="mso-bidi-font-weight:
normal"><span style="font-family:Tahoma">Colunas que n&atilde;o podem ser alteradas<o:p></o:p></span></b></p>
<p><span style="font-family:Tahoma"><o:p>Colunas que s&atilde;o chaves ou usadas 
  para ligar a outras tabelas n&atilde;o podem ser alteradas e s&atilde;o protegidas 
  pelo TerraView.</o:p></span></p>
</body>
</html>
