<html>
<head>
<title>Consulta por atributos</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>
<body>
<div align="justify">
    	 <b><font size="4" face="Arial, Helvetica, sans-serif">Consulta por atributos</font></b>
      <hr>
  <p><font face="Arial, Helvetica, sans-serif">O módulo de consulta por atributos, 
    mostrado na Figura 1, possibilita a seleção de objetos. O resultado de uma 
    consulta é mostrado através de realces no grid e no mapa exibido no display 
    do TerraView. A cor do realce pode ser configurada através do TerraView mudando-se 
    o <a href="visualQuery.htm">visual de consulta</a>.</font></p>
  <p><font face="Arial, Helvetica, sans-serif">O módulo possui, na parte inferior, 
    uma área de edição onde o usuário pode digitar a consulta diretamente através 
    do teclado ou utilizar as ferramentas aqui fornecidas.</font></p>
<p class="MsoNormal" align="center"><span style="font-family:Tahoma">&nbsp;<img src="query_arquivos/query.PNG" width="443" height="417"><o:p></o:p></span></p>
<p class="MsoNormal" align="center" style="text-align:center"><span
style="font-family:Tahoma">&nbsp;<o:p></o:p>Fig. 1 - Interface de Consulta por 
  Atributos.<o:p></o:p></span></p>
  <p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify;text-indent:
35.45pt"><span
style="font-family:Tahoma">A interface &eacute; projetada para facilitar a formulação 
    de consultas por atributos. Na parte superior, ele possui um combo chamado 
    <em>Atributo</em> que contém os nomes dos atributos do tema. Este combo possibilita 
    a digitação correta do nome do atributo. Consultas com erros de nome de atributos 
    causam erros na execu&ccedil;&atilde;o.<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify;text-indent:
35.45pt"><span
style="font-family:Tahoma"><o:p>Ter no&ccedil;&atilde;o da faixa de valores 
  de um atributo ajuda na formula&ccedil;&atilde;o de consultas. O m&oacute;dulo 
  permite listar esses valores atrav&eacute;s de um check box. Quando este &eacute; 
  ativado, carrega-se o combo com os valores </o:p>ordenado <o:p>de forma crescente. 
  </o:p></span></p>
<p class="MsoNormal" style="margin-bottom:12.0pt;text-align:justify;text-indent:
35.45pt"><span
style="font-family:Tahoma"><o:p></o:p>&nbsp;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify;text-indent:
35.45pt"><b
style="mso-bidi-font-weight:normal"><span style="font-family:Tahoma">Área de edição<o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify;text-indent:
35.45pt"><span
style="font-family:Tahoma">A área de edição funciona da seguinte forma:<o:p></o:p></span> 
<ul style="margin-top:0cm" type="square">
    <li class="MsoNormal"
  style="margin-bottom:6.0pt;text-align:justify;mso-list:
     l18 level1 lfo3;tab-stops:list 36.0pt"><span
    style="font-family:Tahoma">Toda vez que um combo ou um botão da caixa <em>Operadores</em> 
      &eacute; acionado, faz se uma cópia para a área de edição. Essa cópia é 
      colada sobre o cursor da &aacute;rea de texto ou colada sobre uma seleção 
      previamente existente. <o:p></o:p></span></li>
    <li class="MsoNormal"
  style="margin-bottom:6.0pt;text-align:justify;mso-list:
     l18 level1 lfo3;tab-stops:list 36.0pt"><span
    style="font-family:Tahoma">Os botões <em>Undo</em> e <em>Redo</em> recuperam 
      at&eacute; as últimas 100 edições.<o:p></o:p></span></li>
  <li class="MsoNormal"
  style="margin-bottom:6.0pt;text-align:justify;mso-list:
     l18 level1 lfo3;tab-stops:list 36.0pt"><span
    style="font-family:Tahoma">Operações de copiar e colar podem ser feitas com 
    o botão direito do mouse.<o:p></o:p></span></li>
    <li class="MsoNormal"
  style="margin-bottom:6.0pt;text-align:justify;mso-list:
     l18 level1 lfo3;tab-stops:list 36.0pt"><span
    style="font-family:Tahoma">O botão <em>Del</em> remove uma seleção ou remove 
      um caractere à direita do cursor.<o:p></o:p></span></li>
</ul>
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify"><span
style="font-family:Tahoma">&nbsp;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify;text-indent:
35.45pt"><b
style="mso-bidi-font-weight:normal"><span style="font-family:Tahoma">Execução 
  de uma consulta:<o:p></o:p></span></b> 
<ul style="margin-top:0cm" type="square">
    <li class="MsoNormal"
  style="margin-bottom:6.0pt;text-align:justify;mso-list:
     l9 level1 lfo4;tab-stops:list 36.0pt"><span
    style="font-family:Tahoma">O botão <em>Nova Consulta</em> executa a consulta 
      formulada.<o:p></o:p></span></li>
    <li class="MsoNormal"
  style="margin-bottom:6.0pt;text-align:justify;mso-list:
     l9 level1 lfo4;tab-stops:list 36.0pt"><span
    style="font-family:Tahoma">O botão <em>Adicionar</em> adiciona o resultado 
      da consulta formulada ao resultado já existente.<o:p></o:p></span></li>
    <li class="MsoNormal"
  style="margin-bottom:6.0pt;text-align:justify;mso-list:
     l9 level1 lfo4;tab-stops:list 36.0pt"><span
    style="font-family:Tahoma">O botão <em>Filtrar</em> executa a consulta formulada 
      sobre o resultado já existente.<o:p></o:p></span></li>
</ul>
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify"><span
style="font-family:Tahoma">&nbsp;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify;text-indent:
35.45pt"><b
style="mso-bidi-font-weight:normal"><span style="font-family:Tahoma">Outros botões:<o:p></o:p></span></b> 
<ul style="margin-top:0cm" type="square">
    <li class="MsoNormal"
  style="margin-bottom:6.0pt;text-align:justify;mso-list:
     l7 level1 lfo5;tab-stops:list 36.0pt"><span
    style="font-family:Tahoma">O botão <em>Ajuda</em> mostra esta tela de ajuda.<o:p></o:p></span></li>
    <li class="MsoNormal"
  style="margin-bottom:6.0pt;text-align:justify;mso-list:
     l7 level1 lfo5;tab-stops:list 36.0pt"><span
    style="font-family:Tahoma">O botão <em>Cancelar</em> desativa o módulo de 
      consulta. <o:p></o:p></span></li>
</ul>
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify;text-indent:
35.45pt"><span
style="font-family:Tahoma">&nbsp;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify;text-indent:
35.45pt"><b
style="mso-bidi-font-weight:normal"><span style="font-family:Tahoma">Algumas considerações:<o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify;text-indent:
35.45pt"><b
style="mso-bidi-font-weight:normal"><span style="font-family:Tahoma"><o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify;text-indent:
35.45pt"><b
style="mso-bidi-font-weight:normal"><span style="font-family:Tahoma">Letras Mai&uacute;sculas 
  e Min&uacute;sculas<o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify;text-indent:
35.45pt"><span
style="font-family:Tahoma">Dependendo do gerenciador de banco de dados pode ou 
  não fazer a distin&ccedil;&atilde;o entre letras maiúsculas e minúsculas.<o:p> 
  </o:p></span></p>
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify;text-indent:
35.45pt"><b
style="mso-bidi-font-weight:normal"><span style="font-family:Tahoma"><o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify;text-indent:
35.45pt"><b
style="mso-bidi-font-weight:normal"><span style="font-family:Tahoma">O operador 
  LIKE<o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify;text-indent:
35.45pt"><span
style="font-family:Tahoma">Este operador utiliza o caractere % para indicar um 
  <i>string</i> qualquer de valores. Pode ser aplicado 
  em qualquer tipo de campo e deve ser sempre colocado entre plicas. Alguns exemplos 
  são mostrados a seguir:<o:p></o:p></span> 
<ul style="margin-top:0cm" type="disc">
  <li class="MsoNormal"
  style="margin-bottom:6.0pt;text-align:justify;mso-list:
     l2 level1 lfo1;tab-stops:list 36.0pt"><span
    style="font-family:Tahoma">Para selecionar objetos, cujos nomes, começam com 
    a letra A:<o:p></o:p></span> 
    <p><span
style="font-family:Tahoma">Nome LIKE 'A%'</span> </p>
  </li>
  <li><span
    style="font-family:Tahoma">Para selecionar objetos, cujos nomes, começam com 
    a letra A e terminam com a letra S:<o:p></o:p></span> 
    <p><span
style="font-family:Tahoma">Nome LIKE 'A%S'</span></p>
  </li>
  <li><span
    style="font-family:Tahoma">Para selecionar objetos, cujos nomes, começam com 
    a letra A e terminam com a letra S e tenha o string NH entre eles.<o:p></o:p></span> 
    <p><span
style="font-family:Tahoma">Nome LIKE 'A%NH%S'<o:p></o:p></span></p>
  </li>
  <li> <span
    style="font-family:Tahoma">Para selecionar objetos, cujos nomes, começam com 
    o string RUA.<o:p></o:p></span> 
    <p><span
style="font-family:Tahoma">Nome LIKE 'RUA%'<o:p></o:p></span> </p>
  </li>
  <li> <span
    style="font-family:Tahoma">Para selecionar objetos, cujos nomes, começam com 
    o string 487.<o:p></o:p></span> 
    <p><span
style="font-family:Tahoma">Nome LIKE '487%'<o:p></o:p></span> </p>
  </li>
</ul>
 &nbsp; 
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify;text-indent:
35.45pt"><span
style="font-family:Tahoma"><o:p></o:p>&nbsp;<o:p></o:p></span><b
style="mso-bidi-font-weight:normal"><span style="font-family:Tahoma">Tema com 
  ligação 1 para n<o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify"><span
style="font-family:Tahoma">Nesse caso pode-se ou n&atilde;o utilizar as fun&ccedil;&otilde;es 
  de agrega&ccedil;&atilde;o. As fun&ccedil;&otilde;es podem ser:<o:p></o:p></span></p>
<ul style="margin-top:0cm" type="circle">
  <li class="MsoNormal"
  style="margin-bottom:6.0pt;text-align:justify;mso-list:
     l3 level1 lfo2;tab-stops:list 36.0pt"><span
style="font-family:Tahoma"><o:p></o:p>MIN<o:p></o:p></span></li>
  <li><span
    style="font-family:Tahoma">MAX<o:p></o:p></span></li>
  <li class="MsoNormal"
  style="margin-bottom:6.0pt;text-align:justify;mso-list:
     l3 level1 lfo2;tab-stops:list 36.0pt"><span
    style="font-family:Tahoma">AVG<o:p></o:p></span></li>
  <li class="MsoNormal"
  style="margin-bottom:6.0pt;text-align:justify;mso-list:
     l3 level1 lfo2;tab-stops:list 36.0pt"><span
    style="font-family:Tahoma">SUM e<o:p></o:p></span></li>
  <li class="MsoNormal"
  style="margin-bottom:12.0pt;text-align:justify;mso-list:
     l3 level1 lfo2;tab-stops:list 36.0pt"><span
    style="font-family:Tahoma">COUNT<o:p></o:p></span></li>
</ul>
<p><span
style="font-family:Tahoma"> Essas fun&ccedil;&otilde;es possibilitam que v&aacute;rios 
  valores sejam associados a um objeto. Alguns exemplos s&atilde;o mostrados a 
  seguir:<o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify;text-indent:
35.45pt"><span
    style="font-family:Tahoma">Selecionar municípios que tem, em m&eacute;dia, 
  em suas escolas mais de 50 professores.</span> 
  
  <p><span
style="font-family:Tahoma">AVG(num_professores) &gt; 50</span></p>
 
<p><span
style="font-family:Tahoma">Nesse exemplo &eacute; suposto que exista um tema de 
  munic&iacute;pios ligado &agrave; tabela externa &quot;escolas&quot; e num_professores 
  &eacute; um atributo da tabela &quot;escolas&quot;. Essa consulta seleciona 
  todos os munic&iacute;pios que tem, na m&eacute;dia, mais que 50 professores 
  em suas escolas.</span></p>
<p>&nbsp;</p>
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify;text-indent:
35.0pt"><span
style="font-family:Tahoma"><o:p>Retirando-se a fun&ccedil;&atilde;o de agrega&ccedil;&atilde;o 
  obt&eacute;m-se outro resultado. Nesse caso a consulta seleciona todas as escolas que 
  possuem mais de 50 professores.</o:p></span></p>
  
  <p><span
style="font-family:Tahoma">num_professores &gt; 50<o:p></o:p></span></p>
 
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify"><span
style="font-family:Tahoma">Nesse caso o resultado &eacute; exibido da seguinte 
  forma:<o:p></o:p></span></p>
<ul>
  <li><span
style="font-family:Tahoma">são realçados no grid todas as escolas que tem mais 
    de 50 professores<o:p></o:p></span></li>
  <li><span
style="font-family:Tahoma">são realçados no display (mapa) todos os municípios 
    que tenha pelo menos uma escola que satisfaça a consulta, ou seja, apenas 
    os municípios que não possuem nenhuma escola com mais de 50 professores são 
    deixados sem realce.<o:p></o:p></span></li>
</ul>
<p class="MsoNormal"
style="margin-top:0cm;margin-right:0cm;margin-bottom:6.0pt;
margin-left:20.0pt;text-align:justify;text-indent:0cm;mso-list:l11 level1 lfo20;
tab-stops:list 20.0pt"><span
style="font-family:Tahoma"><o:p></o:p></span></p>
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify;text-indent:
35.45pt"><span
style="font-family:Tahoma">Fun&ccedil;&otilde;es de agrega&ccedil;&atilde;o devem 
  ser aplicadas a todos os atributos existentes na consulta formulada. Dessa forma 
  a consulta seguinte n&atilde;o &eacute; v&aacute;lida.<o:p></o:p></span></p>
  
  <p><span
style="font-family:Tahoma">SUM(num_professores) &gt; 350 AND num_salas &gt; 30 
    ......ERRO</span></p>
  <p><span
style="font-family:Tahoma"><o:p>uma mensagem de erro &eacute; enviada ao executar 
    essa consulta.</o:p></span></p>
 
<p class="MsoNormal" style="margin-bottom:6.0pt;text-align:justify;text-indent:
35.45pt"><b
style="mso-bidi-font-weight:normal"><span style="font-family:Tahoma">&nbsp;<o:p></o:p></span></b><span
style="font-family:Tahoma"><o:p></o:p></span></p>
</div>
</body>
</html>
